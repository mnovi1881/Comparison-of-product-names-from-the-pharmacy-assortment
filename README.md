# Comparison-of-product-names-from-the-pharmacy-assortment
Сопоставление названий товаров из ассортимента аптек
Представьте, что вы работаете в аптеке. Периодически нужно заказывать лекарства у разных поставщиков. Обычно для заказа используют Excel, формулу ВПР и т д, которые помогают сравнивать 2 списка - список необходимых товаров с каталогом поставщиков. А что если в этих списках товары называются по-разному? Сколько времени затратит сотрудник для ручного “сравнивания” таблиц? Какое количество ошибок мы получим при таком заказе? А если нам придется делать это регулярно?

Перейдем к конкретной цели - Разработать алгоритм который: Сравнивает названия из разных списков Находит совпадения с точностью больше 80% Работает быстро и не “убивает” все ресурсы офисной техники

У нас есть несколько файлов. краткий файл с уже проставленными категориями товара огромный файл с разными наименованиями, повторениями и т д

Короткий файл мы использовали для обучения модели - он значительно меньше, имеет названия и верные категории товара.На нем можем попробовать “обучение с учителем”.

Основные этапы: Лемматизация - приводим названия к единому виду(например, таблетки - таблетка) Токенизация - делим слова на список, выделяя каждое слово для удаления например, предлогов Удаляем спецсимволы и приводим все слова к нижнему регистру.

Переходим к следующему этапу - нам нужно превратить слова в числа. для этого нам поможет Векторизация. Используем CountVectorizer чтобы посчитать частоту слов и TD-IDF для того, чтобы понять важность или вес слов. Например, слово “таблетки” встречается очень часто и его важность маленькая. А слово “Ибупрофен” используется редко и у него значительный вес.

Далее мы получаем очищенный и пред обработанный текст, подходящий к методам обучения: Логистическая регрессия - простая линейная модель Ансамблевые методы на деревьях (случайный лес и CatBoost) — мощные нелинейные алгоритмы Глубокое обучение (нейронная сеть) — максимально гибкий, но ресурсоёмкий метод

Почему они? ответ прост - Выбор алгоритма машинного обучения всегда зависит от компромисса между точностью (accuracy) и вычислительными затратами (временем обучения) Эти методы охватывают основные подходы к задаче классификации

Переходим к самому обучению. Попробуем с самого простого - логистической регрессии. Зачем? Проверка, насколько хорошо задача решается линейной моделью. Плюсы: Очень быстрое обучение (1 мин). Интерпретируемость (можно анализировать веса признаков). Минусы: Низкая точность (82.9%), если данные сложные. Когда выбирать? Для базовой проверки гипотезы (если accuracy >80% хватит). Если важна скорость, а не максимальная точность.

Логистическая регрессия представляет собой наиболее простое и быстрое решение. Эта модель обучается буквально за 1-2 минуты и демонстрирует точность около 83%. Ее главное преимущество - прозрачность работы: мы можем точно определить, какие именно слова в названии лекарства влияют на результат. Однако она плохо справляется со сложными случаями, когда важно учитывать сочетания слов или контекст. Это идеальный вариант для начального этапа автоматизации.

Случайный лес (Random Forest) Зачем? Улучшение точности за счёт нелинейности и ансамбля деревьев. Плюсы: Автоматически обрабатывает нелинейные зависимости. Устойчив к переобучению (в отличие от одного дерева). Даёт importance-признаков (какие слова влияют на категорию). Минусы: Медленнее логистической регрессии (15 мин). Когда выбирать? Если нужна точность выше, чем у линейной модели, но без долгого обучения

Случайный лес предлагает более продвинутый подход. Эта модель состоит из множества деревьев решений, которые становятся основой для нее. С точностью 85% она лучше справляется с вариациями написания и опечатками. Обучение занимает 15-20 минут, что делает ее хорошим выбором. При этом она сохраняет относительную простоту внедрения и не требует специального оборудования.

CatBoost Зачем? Проверить, как бустинг на деревьях справится с задачей. Плюсы: Лучше работает с категориальными данными (например, текстами после токенизации). Автоматически борется с переобучением. Часто даёт лучшую accuracy, чем случайный лес (87.3% vs 85.1%). Минусы: Дольше обучается (45 мин). Когда выбирать? Если важно максимальное качество без перехода к нейросетям

CatBoost(градиентный бустинг) - это современный алгоритм, который показывает наилучшие результаты среди классических методов машинного обучения. С точностью 87% он особенно хорош для работы с текстовыми данными. Его ключевое преимущество - автоматическая обработка различных форм написания лекарств. Однако для обучения требуется около 45 минут, а также больше вычислительных ресурсов. Это решение подходит там, где важна максимальная точность.

Нейронная сеть Зачем? Проверить, даст ли глубокое обучение значимый прирост accuracy. Плюсы: Максимальная гибкость (может выучить сложные паттерны). Лучший результат (88.1%). Минусы: Очень долгое обучение (>2 часа). Требует тонкой настройки (слои, регуляризация, dropout). Когда выбирать? Если разница в 3-5% accuracy критична (например, в коммерческом проекте). Если есть ресурсы (GPU) и время на эксперименты

Нейронные сети демонстрируют наивысшую точность - 88%. Они способны улавливать сложные закономерности и контекстные зависимости в названиях лекарств. Однако их использование сопряжено с серьезными требованиями: обучение занимает более 2 часов и требует мощных графических процессоров. Кроме того, принципы их работы сложно интерпретировать. Такое решение стоит рассматривать только для торговых сетей с очень большими объемами данных и доступом к промышленным вычислительным мощностям, к специализированному аппаратному обеспечению для глубокого обучения

Почему не другие методы? Метод опорных векторов (SVM)? Мог бы быть альтернативой, но хуже масштабируется на большие текстовые данные. k ближайших соседей? Бесполезен для текстов, так как требует вычисления расстояний между тысячами слов. XGBoost или LightGBM? Икс-Джи-Буст или Лайт-Джи-Би-Эм Аналогичны CatBoost, но CatBoost лучше работает с категориями "из коробки"

При внедрении автоматизированных систем анализа данных важно учитывать не только итоговую точность модели, но и целый комплекс сопутствующих факторов. Каждая аптечная сеть имеет свою специфику работы, объемы данных и доступные ресурсы, поэтому универсального решения не существует — ключевым становится осознанный выбор, основанный на тщательном анализе потребностей бизнеса.

Для небольших аптек, где критически важны простота внедрения и низкие вычислительные затраты, оптимальным стартом может стать логистическая регрессия. Эта модель, несмотря на свою кажущуюся простоту, уже способна обеспечить значительное улучшение по сравнению с ручной обработкой, при этом не требуя серьезных мощностей или длительного обучения.

Средним и растущим сетям, стремящимся к повышению точности без чрезмерного усложнения инфраструктуры, стоит обратить внимание на метод случайного леса. Данный алгоритм демонстрирует отличный баланс между интерпретируемостью, скоростью работы и качеством предсказаний, что делает его одним из самых популярных решений в индустрии. Его гибкость позволяет адаптироваться к различным типам данных, а относительная простота настройки сокращает время на внедрение.

Крупным игрокам рынка, имеющим доступ к обширным данным и стремящимся к максимальной эффективности, может быть особенно интересен CatBoost. Этот алгоритм сочетает в себе высокую точность, устойчивость к переобучению и эффективную работу с категориальными признаками, что особенно актуально для фармацевтической сферы. При этом он остается более экономичным решением по сравнению с глубоким обучением, не требуя экстремальных вычислительных мощностей.

Нейронные сети — это премиальный инструмент для случаев, когда критически важен каждый дополнительный процент точности. Их применение оправдано лишь в условиях действительно больших объемов данных и наличия специализированной инфраструктуры, поскольку обучение таких моделей требует не только времени, но и серьезных вложений в оборудование.

Преимущества автоматизации: не только точность, но и бизнес-эффективность

Важно понимать, что даже самые простые из рассмотренных моделей уже дают колоссальное преимущество перед традиционными методами ручной обработки. Внедрение машинного обучения — это не просто технологический апгрейд, а стратегическое решение, которое:

Сокращает временные затраты — сотрудники перестают тратить часы на рутинные задачи и могут сосредоточиться на более важных аспектах работы.

Минимизирует человеческий фактор — количество ошибок в заказах снижается в разы, что напрямую влияет на удовлетворенность клиентов.

Повышает операционную эффективность — автоматизация ускоряет процессы, снижает издержки и в долгосрочной перспективе улучшает финансовые показатели.

Таким образом, переход на алгоритмическую обработку данных — это не просто модернизация IT-инфраструктуры, а вклад в устойчивое развитие бизнеса, позволяющий аптечным сетям оставаться конкурентоспособными в условиях растущего рынка.
